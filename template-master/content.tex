\subsection{Summary}\label{summary}}

This paper reports the successful reproduction of the results in a paper
I co-authored in 2008 (Eglen and Wong 2008). A postprint of this paper
is available at \url{https://arxiv.org/abs/1208.0986}. (Open access was
not mandated by the funders of this research at the time of publication,
2008.) All the code has been uploaded to
\url{https://github.com/sje30/rescience-hor} along with the Rmarkdown
sources for this report.

\hypertarget{historical-context}{%
\section{Historical context}\label{historical-context}}

\hypertarget{scientific-question}{%
\subsection{Scientific question}\label{scientific-question}}

To investigate a problem in neurobiology concerning the relative spatial
positioning of two types of neuron in the retina. We used three example
datasets (pretty much all that was available at the time) to investigate
this problem using spatial statistics and simulations of spatial
patterning. These datasets were not available in digital format, but the
images (Wässle, Peichl, and Boycott 1978; Wässle et al. 2000) were
scanned in and digitised (each cell represented as an x,y location) by
me as part of the work for the original paper. These datasets were not
publicly shared before.

\hypertarget{computational-context}{%
\subsection{Computational context}\label{computational-context}}

Most of the code required for the 2008 paper had been developed by
myself since about 2000 working on other related problems. The major
innovation here was in the biological problem.

One of the key reasons I switched to R as a programming environment in
the late 1990s was because of the strong support it had for spatial
statistics. In particular the SPLANCS package (Rowlingson and Diggle
2017) in R has been a key package in most of my research.

\hypertarget{original-source-code}{%
\subsection{Original source code}\label{original-source-code}}

the original source code was not published or publicly archived before.
The source code was kept just on my hard drive. I keep good backups
though, and in this case the projects were still in my home directory
(copied from machine to machine over the years). No license was written
systematically to cover the code I wrote, although the R packages are
usually released under GPL or MIT.

As a side-effect of producing this article, the following R packages of
mine were made available:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  sjedmin: dmin model for spatial point patterns.
  \url{https://github.com/sje30/sjedmin}
\item
  sjedist: unified calculation of spatial statistics.
  \url{https://github.com/sje30/sjedist}
\item
  sjevor: Wrapper around public domain code for Voronoi tessellation
  \url{https://github.com/sje30/sjevor}
\end{enumerate}

The Voronoi tessellation was public domain C code provided by Steve
Fortune (Fortune 1987). (This code was not required for the current
project, but was implicitly required for the parent package, sjedist.)

\hypertarget{retrieval-of-the-software}{%
\subsection{Retrieval of the software}\label{retrieval-of-the-software}}

This was relatively straightforward, as the software was all on my hard
drive. One complication was that until a few years ago, I had been using
RCS as my primary version control software. As I wished to release the
packages onto github, I converted the history from RCS into Git using
the tool \texttt{https://github.com/Oblomov/rcs-fast-export}.

I anticipated that loading the data might be tricky, as I had used R's
internal Rda format to efficiently store the data files (they are not
large, so there was no need to be concerned about efficiency). Given
that this format could in principle change over time, this might have
been a problem. However, R 4.0.0 was able to read in the file
\texttt{bivariate\_mosaics.Rda}.

\hypertarget{execution}{%
\section{Execution}\label{execution}}

The code ran fine in today's version of R (4.0.0); see end of document
for the full list of R dependencies. I did not need to load any older
versions of libraries. The code was tested on both my laptop (ThinkPad
T480s running Manjaro linux) and on \url{https://mybinder.org} (see the
end of this document for mybinder details.) The simulations themselves
only take a couple of minutes to run. If recompiling on binder, it takes
a few more minutes to install all the packages and initialise the tex
distribution.

However, although the code worked fine, it took me about 20 minutes to
read through the old scripts and work out what to do, as I had not
provided a Makefile or similar.

Once the code was running, I only wished to make cosmetic updates to the
project to modernise it. The most significant change was converting the
format for figures from postscript to pdf as there is more support for
the latter. The three figures that were generated are reproduced in this
paper and can be compared against the figures from the original paper.

A Makefile is provided to help regenerate the simulation results and the
figures. \emph{make clean} will return the repository to a clean state.
\emph{make all} will first run the simulations and store the results in
several \emph{.Rda} files. There are then several R scripts to generate
the figures from the corresponding \emph{.Rda} files. Finally, after the
figure pdfs have been generated, this document is compiled from its
Rmarkdown source.

\hypertarget{reproduction-of-results}{%
\subsection{Reproduction of results}\label{reproduction-of-results}}

The results generated closely matched those that were presented in the
original paper. As the simulation methods are stochastic (and no seed
was set for reproducible random number generation), the P values
reported in Figure 2 do not match those originally reported, nor does
the simulation field (right hand side of Figure 1) match. However, the
statistical properties of the models still match those of the
experimental data.

\hypertarget{could-someone-else-reproduce-the-work}{%
\subsection{Could someone else reproduce the
work?}\label{could-someone-else-reproduce-the-work}}

If I had simply given the R code and packages to someone else, the lack
of documentation or Makefile would have meant that this person would
have needed to study the code carefully to work out what files were
generated. I would have hoped though that someone fluent with R would
have made sense of the code itself, and all of the parameters for the
simulations were included in the source files.

\hypertarget{reproduction-of-figure-1}{%
\section{Reproduction of Figure 1}\label{reproduction-of-figure-1}}

\includegraphics{hor_fieldA_col.pdf}

We also made a supplementary figure of all 3 fields.

\hypertarget{reproduction-of-figure-2}{%
\section{Reproduction of Figure 2}\label{reproduction-of-figure-2}}

\includegraphics{eglen_fig2_col.pdf}

\hypertarget{reproduction-of-figure-3}{%
\section{Reproduction of Figure 3}\label{reproduction-of-figure-3}}

\includegraphics{eglen_fig3_col.pdf}

\hypertarget{reproduction-of-table-2}{%
\section{Reproduction of Table 2}\label{reproduction-of-table-2}}

Key column from table 2 is the rejects column which is shown here:

\begin{Shaded}
\begin{Highlighting}[]
\VariableTok{$9}\ExtensionTok{37} \DataTypeTok{\textbackslash{}p}\NormalTok{m 36$ }\KeywordTok{\&} \ExtensionTok{15334} \KeywordTok{\&} \ExtensionTok{0.06}
\VariableTok{$7}\ExtensionTok{202} \DataTypeTok{\textbackslash{}p}\NormalTok{m 300$ }\KeywordTok{\&} \ExtensionTok{17716} \KeywordTok{\&} \ExtensionTok{0.41}
\VariableTok{$2}\ExtensionTok{42} \DataTypeTok{\textbackslash{}p}\NormalTok{m 10$ }\KeywordTok{\&} \ExtensionTok{25500} \KeywordTok{\&} \ExtensionTok{0.01}
\end{Highlighting}
\end{Shaded}

Note the order of the three values is field A, B, C, rather than listed
in the original paper (Table 2, C, A, B). The other columns of this
table were determined statically from the data sets, so were not
recalculated here -- the rejects column is the important column here.

(Had I known more about generating tables in R at the time, I think my R
code should have created this entire table.)

\hypertarget{conclusions}{%
\section{Conclusions}\label{conclusions}}

It was relatively easy to recompute the results in this report, because
of the stability of the R environment and its packaging system. Even its
binary data format (.Rda) for storing objects was reusable over a 10
year timescale. The largest challenge was the user issue of remembering
what I had done to run the analysis and generate the results. Using
mybinder.org was useful to iron out minor issues that others might face
trying to run the software on their machine. In its current state, the
repository requires R and make -- if make is unavailable, the scripts
would need to be run by hand, which is not onerous, but writing them out
explicitly might help those unfamiliar with Make syntax.

\hypertarget{about-this-document}{%
\section{About this document}\label{about-this-document}}

This is a reproducible document that you can regenerate within
mybinder.org by following the instructions on the README at the project
home page, \url{http://github.com/sje30/rescience-hor}.

If you are not using mybinder.org to recompile the document, then the
following steps should work to generate the file
\texttt{rescience-hor.pdf} on a unix machine with Make.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{source}\NormalTok{(}\StringTok{\textquotesingle{}install.R\textquotesingle{}}\NormalTok{)}
\FunctionTok{system}\NormalTok{(}\StringTok{\textquotesingle{}make rescience{-}hor.pdf\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\clearpage

\hypertarget{session-information}{%
\section{Session Information}\label{session-information}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sessionInfo}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## R version 4.1.0 (2021-05-18)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Manjaro Linux
## 
## Matrix products: default
## BLAS:   /usr/lib/libopenblasp-r0.3.17.so
## LAPACK: /usr/lib/liblapack.so.3.10.0
## 
## locale:
##  [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8    
##  [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8   
##  [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets 
## [6] methods   base     
## 
## other attached packages:
## [1] knitr_1.33
## 
## loaded via a namespace (and not attached):
##  [1] compiler_4.1.0    magrittr_2.0.1    tools_4.1.0      
##  [4] htmltools_0.5.1.1 yaml_2.2.1        stringi_1.6.2    
##  [7] rmarkdown_2.8     stringr_1.4.0     xfun_0.23        
## [10] digest_0.6.27     rlang_0.4.11      evaluate_0.14
\end{verbatim}

\hypertarget{acknowledgements}{%
\section{Acknowledgements}\label{acknowledgements}}

I thank the R core team for continuing to provide a robust computing
environment that gave me confidence that this code was still work after
10 years. Thanks also to Daniel Nüst and the mybinder team for helping
me learn and use mybinder.

